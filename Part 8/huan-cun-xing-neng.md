## 缓存性能和命中率

命中率定义为缓存命中数除以在指定时间内对缓存发出的内存请求数，通常以百分比计算。类似地，误报率是总缓存误报数除以向缓存发出的总内存请求数。还可以只计算读或写时命中或未命中的次数。

显然，较高的命中率通常会导致更高的性能。引用典型软件的示例数据是不可能的，命中率非常依赖于代码或数据的关键部分的大小和空间位置，当然还有缓存的大小。

有一些简单的规则可以遵循，以提供更好的性能。其中最明显的是启用缓存和写缓冲区，并尽可能使用它们(通常用于包含代码的内存系统的所有部分，通常用于 RAM 和 ROM，但不包括外围设备)。如果对指令内存进行缓存，Cortex-A 系列处理器的性能将大大提高。将经常访问的数据放在内存中也很有帮助。例如，一个频繁访问的数组可能受益于在高速缓存行开头有一个基地址。

在内存中获取数据值涉及到获取整个高速缓存线路;如果缓存线路中没有其他任何一个词会被使用，那么就不会有什么性能提升。通过以一种“缓存友好”的方式访问数据，可以减轻这种情况。例如，对顺序地址的访问，例如访问数组的一行，得益于缓存行为，不可预测或非顺序访问模式，例如链表，则不会。

较小的代码可能比较大的代码缓存效果更好，这有时会产生看似矛盾的结果。例如，当编译为 Thumb (或最小大小)时，C 代码可能完全适合于缓存中，而编译为 ARM (或最大性能)时则不适合，因此实际上可以比更优化的版本运行得更快。缓存注意事项将在第十七章优化代码中详细提及。
