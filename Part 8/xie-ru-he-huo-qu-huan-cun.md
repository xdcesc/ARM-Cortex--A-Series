## 写入和获取缓冲区

写缓冲区是内核中的硬件块(但有时也在系统的其他部分)，使用多个缓冲区实现。它接受与写入内存的核心相关联的地址、数据和控制值。当核心执行存储指令时，它可能会将相关的详细信息(例如写入的位置、要写入的数据和事务大小)放置到缓冲区中。核心不需要等待写操作完成到主内存。它可以继续执行下面的指令。写缓冲区本身会将接受的写操作从核心转移到内存系统。

写缓冲区可以提高系统的性能。它将核心从等待存储完成的等待中解放出来。实际上，如果写缓冲区中有空间，写缓冲区是隐藏延迟的一种方法。如果写的次数很少或间隔很好，写缓冲区将不会被填满。如果内核生成写操作的速度快于它们被耗尽到内存的速度，那么写缓冲区最终会被填满，并且不会带来什么性能上的好处。

一些写缓冲区支持 write merging (也称为 write combining)。它们可以接受多个写入操作(例如，对相邻字节的写入流)，并将它们合并为单个突发。这可以减少对外部内存的写流量，从而提高性能。

很明显，有时候写缓冲区的行为不是您访问外设时想要的，您可能希望内核停止并等待写完成，然后再继续下一步。有时候，您确实希望编写一个字节流，而不希望组合存储。第十章的 ARM 内存排序模型描述了 ARM 体系结构支持的内存类型，以及如何使用这些类型来控制缓存和写缓冲区是如何用于内存映射的特定设备或部分的。

类似的组件称为 fetch buffer，可以用于某些系统的读取。特别地，核心通常包含预取缓冲区，这些缓冲区在实际插入管道之前从内存中读取指令。一般来说，这样的缓冲区对您来说是透明的。当我们查看内存排序规则时，将考虑与此相关的一些可能的危害。
